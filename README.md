# Malware.Analysis.Utils
The tools I daily use on my research

## Tools

Tool's description

### Pcap2Json

A tool to parse pcap files in order to find suspicious actions. The parsed data
is dumped on JSON format, as shown below:

```json
"HTTP": [{
		"Host": "bailXXXX.com",
		"Protocol": "HTTP",
		"IPdst": "209.99.Y.Z",
		"Path": "/Faculdade/Walts.zip",
		"PortDST": 80,
		"IPsrc": "192.168.1.1",
		"PortSRC": 49169,
		"Method": "GET"
	  }],
"DNS": [{"entry": [ {
		"Protocol": "DNS", 
		"IPdst": "192.168.1.1", 
		"PortDST": 53, 
		"IPsrc": "192.168.1.1", 
		"Type": "QUERY", 
		"PortSRC": 55604, 
		"Name": "time.windows.com."
	  }]},], 

```

### Honeypot2Run

A tool for scheduling samples for analysis procedures as soon as they are
trapped by a honeypot. The tool is Inotify based and is intended to be running
on background. The tool can span many analysis procedures at time, as shown
below:

```
[INOTIFY] IN_CLOSE_WRITE called. PATH: /tmp/malware NAME: malware1 PATHNAME:
/tmp/malware/malware1
[INOTIFY] IN_CLOSE_WRITE called. PATH: /tmp/malware NAME: malware2 PATHNAME:
/tmp/malware/malware2
[Thread 1]: malware1 popped for analysis 
[INOTIFY] IN_CLOSE_WRITE called. PATH: /tmp/malware NAME: malware3 PATHNAME:
/tmp/malware/malware3
[Thread 2]: malware2 popped for analysis 
[INOTIFY] IN_CLOSE_WRITE called. PATH: /tmp/malware NAME: malwareN PATHNAME:
/tmp/malware/malwareN
[Thread 3]: malware3 popped for analysis
```

### Hasher

A tool to calculate all hashes of a given binary, so you can check on internet
if the given threat is already known. An execution example is shown below:

```
Hashes of /bin/bash
[SSDEEP]  :
12288:khRO05dvtF0rztLGcXNnxX3BlJDd1XLsNbb8ckf9PSKMedh50jn58r0mUX:kXR5dvY/tLGcXNB3Bldnobu7MedbSnh
[CRC32]   :    0x594e4450
[MD5]     :    164ebd6889588da166a52ca0d57b9004
[SHA1]    :    8e3aa19fdc42e87659746f6dc8ea3af74ab30362
[SHA224]  :    ad640f0e92c5f2df008518269196925be0cc0f7679fcd6ce8ddc1dea
[SHA256]  :    8c4d49445d0050884e0703571f187338b10c7836b08ed822cc5fc6cf15ac76b0
[SHA384]  :
6be640b6fe9fe9e077b2f7bf5f85c446f70aa635ceb88a993e148ee0eee2caad9725a4a12c3eefc50961ea5a0a048769
[SHA512]  :
cc7cb38021a7604f2fd5a54a3013e15bba3b752f7815c11e64638234b386dd91c5d970a6d1c73d4af9945a2c258048486632d6a69b44f4c8448f7f8d4e
```

### PE2Json

Retrieves PE informationg of a given binary, using pefile, and prints it on JSON
format, as shown below:

```json
 "Imports": [
    {
     "Name ": "Sleep", 
     "Address": "0x140003028"
    }, 
    {
     "Name ": "GetSystemTimeAsFileTime", 
     "Address": "0x140003030"
    }, 
    {
     "Name ": "GetCurrentThreadId", 
     "Address": "0x140003038"
    }, 
    {
     "Name ": "QueryPerformanceCounter", 
     "Address": "0x140003040"
    }, 
```

### SetPrivileges

A privilege elevation tool to perform analysis using higher privileges.
