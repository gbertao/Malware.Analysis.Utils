#!/usr/bin/env python

# Marcus Botacin
# get vm data and revert VM to a previous state

import sys # args
import xml_parser as p # get VM info
import libvirt as l # manage VMs

def main(vm):

	snap = p.find_snap(vm)
	name = p.find_name(vm)

	if __debug__:
		print("[VM %d] %s - Reverting Snapshot %s." % (vm,name,snap))

	conn = l.open('qemu:///system')
	dom0 = conn.lookupByName(name)
	snap1=dom0.snapshotLookupByName(snap,0)
	dom0.revertToSnapshot(snap1,1)

	if __debug__:
		print("Put your code here!")

	dom0.destroy()

# usage message
def usage(bin_name):
	print("python %s <vm_number>" % bin_name)

# direct call
if __name__ == '__main__':
	# name + arg
	if(len(sys.argv)==2):
		main(int(sys.argv[1]))
	else:
		usage(sys.argv[0])
else:
	# module import
	print("No module import support Yet!")
