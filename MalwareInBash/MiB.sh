is_pe()
{
	[ $# -eq 0 ] && echo "False" && return 1
	file $1 | grep "PE32" >/dev/null;
	[ $? -eq 1 ] && echo "False" && return 1;
	echo "True"
}

is_pe32()
{
	[ $# -eq 0 ] && echo "False" && return 1
	[ `is_pe $1` == "False" ] && echo "False" && return 1;
	file $1 | cut -d' ' -f2 | grep "PE32+" >/dev/null;
	[ $? -eq 0 ] && echo "False" && return 1;
	echo "True"
}

is_pe64()
{
	[ $# -eq 0 ] && echo "False" && return 1
	file $1 | cut -d' ' -f2 | grep "PE32+" >/dev/null;
	[ $? -eq 1 ] && echo "False" && return 1;
	echo "True"
}

is_dll()
{
	[ $# -eq 0 ] && echo "False" && return 1;
	python utils/is_dll.py $1;
}

get_ext()
{
	[ $# -eq 0 ] && echo "False" && return 1;
	[[ $1 == *"."* ]] && echo $1 | rev | cut -d'.' -f1 | rev && return 0;
	echo "False" && return 1;
}

is_dotnet()
{
	[ $# -eq 0 ] && echo "False" && return 1
	file $1 | cut -d' ' -f7 | grep ".Net" >/dev/null;
	[ $? -eq 1 ] && echo "False" && return 1;
	echo "True"
}

get_section()
{
	[ $# -eq 0 ] && echo "False" && return 1
	objdump -h $1 | awk 'NR > 5' | grep -e "[0-9]" | cut -d' ' -f4;
}

print_is_pe()
{
	for i in `ls`; do 
	if [ `is_pe $i` == "True" ]; then 
		echo $i;
	fi;
	done;
}

print_is_pe32()
{
	for i in `ls`; do 
	if [ `is_pe32 $i` == "True" ]; then 
		echo $i;
	fi;
	done;
}

print_is_pe64()
{
	for i in `ls`; do 
	if [ `is_pe64 $i` == "True" ]; then 
		echo $i;
	fi;
	done;
}

print_is_dll()
{
	for i in `ls`; do 
	if [ `is_dll $i` == "True" ]; then 
		echo $i;
	fi;
	done;
}

print_is_dotnet()
{
	for i in `ls`; do 
	if [ `is_dotnet $i` == "True" ]; then 
		echo $i;
	fi;
	done;
}

echo "Malware in Bash"
